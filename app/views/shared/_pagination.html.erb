<% if collection.respond_to?(:current_page) && collection.total_pages > 1 %>
  <% base_params = request.query_parameters.symbolize_keys.except(:page) %>
  <nav aria-label="Pagination" class="flex flex-col sm:flex-row items-center justify-between gap-4 py-4">
    <!-- Page info -->
    <div class="text-sm text-gray-600 order-1 sm:order-1">
      Page <%= collection.current_page %> of <%= collection.total_pages %>
      <span class="hidden sm:inline">(<%= collection.total_entries %> total)</span>
    </div>

    <!-- Page numbers -->
    <div class="hidden sm:flex items-center space-x-1 order-2">
      <!-- First page -->
      <% if collection.current_page > 3 %>
        <%= link_to "1", base_params.merge(page: 1), class: "bb-pagination-num" %>
        <% if collection.current_page > 4 %>
          <span class="inline-flex items-center justify-center w-10 h-10 text-sm font-medium text-gray-400">...</span>
        <% end %>
      <% end %>

      <!-- Page numbers around current page -->
      <% start_page = [collection.current_page - 2, 1].max %>
      <% end_page = [collection.current_page + 2, collection.total_pages].min %>

      <% (start_page..end_page).each do |page| %>
        <% if page == collection.current_page %>
          <span class="bb-pagination-num--active"><%= page %></span>
        <% else %>
          <%= link_to page.to_s, base_params.merge(page: page), class: "bb-pagination-num" %>
        <% end %>
      <% end %>

      <!-- Last page -->
      <% if collection.current_page < collection.total_pages - 2 %>
        <% if collection.current_page < collection.total_pages - 3 %>
          <span class="inline-flex items-center justify-center w-10 h-10 text-sm font-medium text-gray-400">...</span>
        <% end %>
        <%= link_to collection.total_pages.to_s, base_params.merge(page: collection.total_pages), class: "bb-pagination-num" %>
      <% end %>
    </div>

    <!-- Previous/Next buttons -->
    <div class="flex items-center space-x-2 order-3 sm:order-3">
      <!-- Previous button -->
      <% if collection.previous_page %>
        <%= link_to "← Previous", base_params.merge(page: collection.previous_page),
            class: "bb-pagination-btn",
            title: "Previous page" %>
      <% else %>
        <span class="bb-pagination-btn--disabled">← Previous</span>
      <% end %>

      <!-- Next button -->
      <% if collection.next_page %>
        <%= link_to "Next →", base_params.merge(page: collection.next_page),
            class: "bb-pagination-btn",
            title: "Next page" %>
      <% else %>
        <span class="bb-pagination-btn--disabled">Next →</span>
      <% end %>
    </div>
  </nav>
<% end %>
