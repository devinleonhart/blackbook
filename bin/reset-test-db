#!/bin/bash

# Reset and seed test database
# This script follows Rails conventions for test database management

set -e

echo "ğŸ§ª Resetting test database..."

# Ensure containers are running
echo "ğŸ³ Starting containers..."
docker compose up -d

# Wait for database to be ready
echo "â³ Waiting for database to be ready..."
sleep 5

# Reset and seed test database
echo "ğŸ—„ï¸  Resetting and seeding test database..."
docker compose exec blackbook bundle exec rails db:reset RAILS_ENV=test

echo "âœ… Test database reset and seeded successfully!"
echo ""
echo "ğŸ” Test accounts:"
echo "  Admin: admin@blackbook.dev / password123"
echo "  Writer: writer@blackbook.dev / password123"
echo "  Collaborator: collaborator@blackbook.dev / password123"
