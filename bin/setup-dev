#!/bin/bash

# Complete development environment setup
echo "Setting up Blackbook development environment..."

# Start containers
echo "Starting Docker containers..."
docker compose up -d

# Wait for database
echo "Waiting for database to be ready..."
sleep 10

# Setup database
echo "Setting up database..."
docker compose exec blackbook bundle exec rails db:create
docker compose exec blackbook bundle exec rails db:migrate
docker compose exec blackbook bundle exec rails db:seed

# Setup test database
echo "Setting up test database..."
docker compose exec blackbook bundle exec rails db:create RAILS_ENV=test
docker compose exec blackbook bundle exec rails db:migrate RAILS_ENV=test
docker compose exec blackbook bundle exec rails db:seed RAILS_ENV=test

echo ""
echo "ðŸŽ‰ Development environment ready!"
echo "ðŸ“± Application: http://localhost:3001"
echo "ðŸ‘¤ Admin login: admin@blackbook.dev / password123"
echo "ðŸ‘¤ Writer login: writer@blackbook.dev / password123"
echo "ðŸ‘¤ Collaborator login: collaborator@blackbook.dev / password123"
echo ""
echo "ðŸ’¡ Useful commands:"
echo "  ./bin/reset-db        - Reset development database"
echo "  ./bin/reset-test-db   - Reset test database"
echo "  docker compose logs   - View application logs"
echo "  docker compose down   - Stop containers"
